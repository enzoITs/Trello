<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quadro Kanban - Estilo Trello</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #0079bf;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            color: white;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .add-task-btn {
            background-color: #5aac44;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
        }

        .add-task-btn:hover {
            background-color: #61bd4f;
        }

        .board {
            display: flex;
            gap: 16px;
            overflow-x: auto;
            padding-bottom: 16px;
        }

        .column {
            background-color: #ebecf0;
            border-radius: 3px;
            width: 300px;
            min-width: 300px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 150px);
        }

        .column-header {
            padding: 8px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .todo-column .column-title {
            color: #eb5a46;
        }

        .doing-column .column-title {
            color: #f2d600;
        }

        .done-column .column-title {
            color: #61bd4f;
        }

        .add-card {
            color: #5e6c84;
            padding: 8px;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .add-card:hover {
            background-color: #ddd;
        }

        .add-card .plus-icon {
            margin-right: 4px;
            font-size: 16px;
        }

        .cards {
            flex-grow: 1;
            overflow-y: auto;
            margin: 8px 0;
        }

        .card {
            background-color: white;
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 3px;
            box-shadow: 0 1px 0 rgba(9,30,66,.25);
            cursor: pointer;
            position: relative;
        }

        .card:hover {
            background-color: #f4f5f7;
        }

        .card .delete-btn {
            position: absolute;
            top: 4px;
            right: 4px;
            color: #5e6c84;
            opacity: 0;
            transition: opacity 0.2s;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 16px;
        }

        .card:hover .delete-btn {
            opacity: 1;
        }

        .card-form {
            display: none;
            flex-direction: column;
            margin-top: 8px;
        }

        .card-form textarea {
            resize: none;
            padding: 8px;
            border: none;
            border-radius: 3px;
            box-shadow: 0 1px 0 rgba(9,30,66,.25);
            margin-bottom: 8px;
            min-height: 60px;
        }

        .card-form-buttons {
            display: flex;
            align-items: center;
        }

        .card-form-buttons button {
            padding: 6px 12px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
        }

        .save-card {
            background-color: #5aac44;
            color: white;
            margin-right: 8px;
        }

        .cancel-card {
            background: none;
            color: #5e6c84;
            font-size: 20px;
        }

        .empty-message {
            color: #5e6c84;
            text-align: center;
            padding: 16px;
            font-style: italic;
        }

        /* Drag and drop styles */
        .card.dragging {
            opacity: 0.5;
            transform: rotate(3deg);
        }

        .column.drop-zone {
            background-color: rgba(0, 121, 191, 0.1);
        }

        @media (max-width: 768px) {
            .board {
                flex-direction: column;
            }
            
            .column {
                width: 100%;
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">Quadro Kanban</div>
        <button class="add-task-btn" id="add-task-btn">+ Adicionar Tarefa</button>
    </div>

    <div class="board" id="board">
        <div class="column todo-column" id="todo-column">
            <div class="column-header">
                <div class="column-title">A Fazer</div>
                <div class="column-menu">⋮</div>
            </div>
            <div class="cards" id="todo-cards">
                <div class="empty-message">Nenhuma tarefa</div>
            </div>
            <div class="add-card" id="add-todo-card">
                <span class="plus-icon">+</span> Adicionar um cartão
            </div>
            <div class="card-form" id="todo-form">
                <textarea placeholder="Digite um título para este cartão..."></textarea>
                <div class="card-form-buttons">
                    <button class="save-card">Adicionar Cartão</button>
                    <button class="cancel-card">×</button>
                </div>
            </div>
        </div>

        <div class="column doing-column" id="doing-column">
            <div class="column-header">
                <div class="column-title">Em Andamento</div>
                <div class="column-menu">⋮</div>
            </div>
            <div class="cards" id="doing-cards">
                <div class="empty-message">Nenhuma tarefa</div>
            </div>
            <div class="add-card" id="add-doing-card">
                <span class="plus-icon">+</span> Adicionar um cartão
            </div>
            <div class="card-form" id="doing-form">
                <textarea placeholder="Digite um título para este cartão..."></textarea>
                <div class="card-form-buttons">
                    <button class="save-card">Adicionar Cartão</button>
                    <button class="cancel-card">×</button>
                </div>
            </div>
        </div>

        <div class="column done-column" id="done-column">
            <div class="column-header">
                <div class="column-title">Concluído</div>
                <div class="column-menu">⋮</div>
            </div>
            <div class="cards" id="done-cards">
                <div class="empty-message">Nenhuma tarefa</div>
            </div>
            <div class="add-card" id="add-done-card">
                <span class="plus-icon">+</span> Adicionar um cartão
            </div>
            <div class="card-form" id="done-form">
                <textarea placeholder="Digite um título para este cartão..."></textarea>
                <div class="card-form-buttons">
                    <button class="save-card">Adicionar Cartão</button>
                    <button class="cancel-card">×</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos do DOM
            const addTaskBtn = document.getElementById('add-task-btn');
            const board = document.getElementById('board');
            
            // Formulários de adição de cartões
            const addTodoCard = document.getElementById('add-todo-card');
            const todoForm = document.getElementById('todo-form');
            const todoTextarea = todoForm.querySelector('textarea');
            const todoSaveBtn = todoForm.querySelector('.save-card');
            const todoCancelBtn = todoForm.querySelector('.cancel-card');
            
            const addDoingCard = document.getElementById('add-doing-card');
            const doingForm = document.getElementById('doing-form');
            const doingTextarea = doingForm.querySelector('textarea');
            const doingSaveBtn = doingForm.querySelector('.save-card');
            const doingCancelBtn = doingForm.querySelector('.cancel-card');
            
            const addDoneCard = document.getElementById('add-done-card');
            const doneForm = document.getElementById('done-form');
            const doneTextarea = doneForm.querySelector('textarea');
            const doneSaveBtn = doneForm.querySelector('.save-card');
            const doneCancelBtn = doneForm.querySelector('.cancel-card');
            
            // Colunas de cartões
            const todoCards = document.getElementById('todo-cards');
            const doingCards = document.getElementById('doing-cards');
            const doneCards = document.getElementById('done-cards');
            
            // Carregar tarefas do localStorage
            loadTasks();
            
            // Evento para adicionar tarefa rápida
            addTaskBtn.addEventListener('click', function() {
                addTodoCard.click();
            });
            
            // Configurar formulários para cada coluna
            setupForm(addTodoCard, todoForm, todoTextarea, todoSaveBtn, todoCancelBtn, 'todo');
            setupForm(addDoingCard, doingForm, doingTextarea, doingSaveBtn, doingCancelBtn, 'doing');
            setupForm(addDoneCard, doneForm, doneTextarea, doneSaveBtn, doneCancelBtn, 'done');
            
            function setupForm(addBtn, form, textarea, saveBtn, cancelBtn, columnType) {
                addBtn.addEventListener('click', function() {
                    form.style.display = 'flex';
                    addBtn.style.display = 'none';
                    textarea.focus();
                });
                
                saveBtn.addEventListener('click', function() {
                    const text = textarea.value.trim();
                    if (text !== '') {
                        createCard(text, columnType);
                        textarea.value = '';
                    }
                    form.style.display = 'none';
                    addBtn.style.display = 'flex';
                });
                
                cancelBtn.addEventListener('click', function() {
                    textarea.value = '';
                    form.style.display = 'none';
                    addBtn.style.display = 'flex';
                });
                
                textarea.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        saveBtn.click();
                    }
                });
            }
            
            function createCard(text, columnType) {
                const card = document.createElement('div');
                card.className = 'card';
                card.textContent = text;
                card.setAttribute('draggable', 'true');
                
                // Botão de excluir
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-btn';
                deleteBtn.innerHTML = '×';
                deleteBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    card.remove();
                    updateEmptyMessages();
                    saveTasks();
                });
                
                card.appendChild(deleteBtn);
                
                // Eventos de drag and drop
                card.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', columnType);
                    setTimeout(() => {
                        card.classList.add('dragging');
                    }, 0);
                });
                
                card.addEventListener('dragend', function() {
                    card.classList.remove('dragging');
                });
                
                // Adicionar à coluna apropriada
                const targetCards = getCardsElement(columnType);
                const emptyMessage = targetCards.querySelector('.empty-message');
                if (emptyMessage) {
                    targetCards.removeChild(emptyMessage);
                }
                targetCards.appendChild(card);
                
                updateEmptyMessages();
                saveTasks();
            }
            
            function getCardsElement(columnType) {
                switch(columnType) {
                    case 'todo':
                        return todoCards;
                    case 'doing':
                        return doingCards;
                    case 'done':
                        return doneCards;
                    default:
                        return todoCards;
                }
            }
            
            function updateEmptyMessages() {
                checkIfEmpty(todoCards);
                checkIfEmpty(doingCards);
                checkIfEmpty(doneCards);
            }
            
            function checkIfEmpty(cardsContainer) {
                const cards = cardsContainer.querySelectorAll('.card');
                const emptyMessage = cardsContainer.querySelector('.empty-message');
                
                if (cards.length === 0 && !emptyMessage) {
                    const message = document.createElement('div');
                    message.className = 'empty-message';
                    message.textContent = 'Nenhuma tarefa';
                    cardsContainer.appendChild(message);
                } else if (cards.length > 0 && emptyMessage) {
                    cardsContainer.removeChild(emptyMessage);
                }
            }
            
            // Configurar zonas de drop para cada coluna
            setupDropZone(todoCards, 'todo');
            setupDropZone(doingCards, 'doing');
            setupDropZone(doneCards, 'done');
            
            function setupDropZone(cardsContainer, columnType) {
                cardsContainer.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    const draggingCard = document.querySelector('.card.dragging');
                    if (draggingCard) {
                        const afterElement = getDragAfterElement(cardsContainer, e.clientY);
                        if (afterElement) {
                            cardsContainer.insertBefore(draggingCard, afterElement);
                        } else {
                            cardsContainer.appendChild(draggingCard);
                        }
                    }
                });
                
                cardsContainer.addEventListener('dragenter', function(e) {
                    e.preventDefault();
                    this.parentElement.classList.add('drop-zone');
                });
                
                cardsContainer.addEventListener('dragleave', function() {
                    this.parentElement.classList.remove('drop-zone');
                });
                
                cardsContainer.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.parentElement.classList.remove('drop-zone');
                    
                    const sourceColumn = e.dataTransfer.getData('text/plain');
                    const card = document.querySelector('.card.dragging');
                    
                    if (card) {
                        // Atualiza a posição no array de tarefas
                        saveTasks();
                    }
                });
            }
            
            function getDragAfterElement(container, y) {
                const draggableElements = [...container.querySelectorAll('.card:not(.dragging)')];
                
                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }
            
            // Salvar tarefas no localStorage
            function saveTasks() {
                const tasks = {
                    todo: [],
                    doing: [],
                    done: []
                };
                
                document.querySelectorAll('#todo-cards .card').forEach(card => {
                    tasks.todo.push(card.textContent.slice(0, -1)); // Remove o × do botão de excluir
                });
                
                document.querySelectorAll('#doing-cards .card').forEach(card => {
                    tasks.doing.push(card.textContent.slice(0, -1));
                });
                
                document.querySelectorAll('#done-cards .card').forEach(card => {
                    tasks.done.push(card.textContent.slice(0, -1));
                });
                
                localStorage.setItem('trelloLikeTasks', JSON.stringify(tasks));
            }
            
            // Carregar tarefas do localStorage
            function loadTasks() {
                const savedTasks = localStorage.getItem('trelloLikeTasks');
                if (savedTasks) {
                    const tasks = JSON.parse(savedTasks);
                    
                    tasks.todo.forEach(text => createCard(text, 'todo'));
                    tasks.doing.forEach(text => createCard(text, 'doing'));
                    tasks.done.forEach(text => createCard(text, 'done'));
                }
            }
        });
    </script>
</body>
</html>